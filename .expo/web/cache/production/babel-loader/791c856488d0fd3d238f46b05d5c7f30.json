{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React,{useState}from'react';import{Center}from\"../components/Center\";import SafeAreaView from\"react-native-web/dist/exports/SafeAreaView\";import Text from\"react-native-web/dist/exports/Text\";import Button from\"react-native-web/dist/exports/Button\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TouchableWithoutFeedback from\"react-native-web/dist/exports/TouchableWithoutFeedback\";import View from\"react-native-web/dist/exports/View\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import TextInput from\"react-native-web/dist/exports/TextInput\";import{LogoutButton}from\"../components/LogoutButton\";import AsyncStorage from'@react-native-async-storage/async-storage';import{buildPath}from\"../functions/BuildPath\";import{FontAwesome}from'@expo/vector-icons';var Budgets=function(_React$PureComponent){_inherits(Budgets,_React$PureComponent);var _super=_createSuper(Budgets);function Budgets(props){var _this;_classCallCheck(this,Budgets);_this=_super.call(this,props);_this.state={budgets:[],show:false,currentBudget:-1,rerender:false,changeAllowance:false,manage:false};return _this;}_createClass(Budgets,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var obj,js;return _regeneratorRuntime.async(function componentDidMount$(_context){while(1){switch(_context.prev=_context.next){case 0:obj={email:AsyncStorage.getItem(\"email\")};js=JSON.stringify(obj);Promise.all([fetch(buildPath('api/showAllBudgets'),{method:'POST',body:js,headers:{'Content-Type':'application/json','Authorization':'Bearer '+AsyncStorage.getItem(\"token\")}}),fetch(buildPath('api/getAllowance'),{method:'POST',body:js,headers:{'Content-Type':'application/json'}})]).then(function(_ref){var _ref2=_slicedToArray(_ref,2),res1=_ref2[0],res2=_ref2[1];return Promise.all([res1.json(),res2.json()]);}).then(function(_ref3){var _ref4=_slicedToArray(_ref3,2),res1=_ref4[0],res2=_ref4[1];var total=0;for(var i=0;i<res1.results.length;i++){total+=res1.results[i].BudgetGoal-res1.results[i].BudgetProgress;}_this2.setState({budgets:res1.results,allowance:res2.allowance,diff:0,index:-1,total:total});});case 3:case\"end\":return _context.stop();}}},null,null,null,Promise);}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,budgets=_this$state.budgets,show=_this$state.show,currentBudget=_this$state.currentBudget,allowance=_this$state.allowance,diff=_this$state.diff,index=_this$state.index,total=_this$state.total;var newName='',newGoal='';var handleClose=function handleClose(){return _this3.setState({show:false});};var handleShow=function handleShow(event){var index;return _regeneratorRuntime.async(function handleShow$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();index=event.currentTarget.getAttribute(\"data-id\");_this3.setState({show:true,currentBudget:index,name:budgets[index].name});case 3:case\"end\":return _context2.stop();}}},null,null,null,Promise);};var remove=function remove(event){handleClose();confirmAlert({title:'Confirm to delete',message:'Are you sure you want to delete this budget?',buttons:[{label:'Yes',onClick:function onClick(){return deleteBudget();}},{label:'No',onClick:function onClick(){return _this3.setState({show:true,currentBudget:event.currentTarget.getAttribute(\"data-id\")});}}]});};var updateBudget=function updateBudget(event){var obj,js,response,txt,res;return _regeneratorRuntime.async(function updateBudget$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();obj={BudgetName:newName,BudgetGoal:newGoal,_id:event.currentTarget.getAttribute(\"data-id\")};js=JSON.stringify(obj);_context3.prev=3;_context3.next=6;return _regeneratorRuntime.awrap(fetch(buildPath('api/updatebudget'),{method:'POST',body:js,headers:{'Content-Type':'application/json','Authorization':'Bearer '+AsyncStorage.getItem(\"token\")}}));case 6:response=_context3.sent;_context3.next=9;return _regeneratorRuntime.awrap(response.text());case 9:txt=_context3.sent;res=JSON.parse(txt);if(res.error.length>0){Alert.alert(\"API Error:\"+res.error);}else{_this3.setState({index:-1});}_context3.next=17;break;case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](3);Alert.alert(_context3.t0.toString());case 17:case\"end\":return _context3.stop();}}},null,null,[[3,14]],Promise);};var addProgress=function addProgress(event){var index,obj,js,obj2,js2;return _regeneratorRuntime.async(function addProgress$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:event.preventDefault();if(!(allowance+diff<0)){_context4.next=4;break;}Alert.alert(\"You can't save your progress as you have a negative allowance.\");return _context4.abrupt(\"return\");case 4:index=event.currentTarget.getAttribute(\"data-index\");obj={email:AsyncStorage.getItem(\"email\"),funds:parseInt(allowance+diff)};js=JSON.stringify(obj);obj2={newAmount:budgets[index].BudgetProgress,_id:event.currentTarget.getAttribute(\"data-id\")};js2=JSON.stringify(obj2);try{Promise.all([fetch(buildPath('api/addAllowance'),{method:'POST',body:js,headers:{'Content-Type':'application/json','Authorization':'Bearer '+AsyncStorage.getItem(\"token\")}}),fetch(buildPath('api/addprogress'),{method:'POST',body:js2,headers:{'Content-Type':'application/json','Authorization':'Bearer '+AsyncStorage.getItem(\"token\")}})]).then(function(_ref5){var _ref6=_slicedToArray(_ref5,2),res1=_ref6[0],res2=_ref6[1];return Promise.all([res1.json(),res2.json()]);}).then(function(_ref7){var _ref8=_slicedToArray(_ref7,2),res1=_ref8[0],res2=_ref8[1];_this3.setState({index:-1});});}catch(e){alert(e.toString()+\"yee\");}case 10:case\"end\":return _context4.stop();}}},null,null,null,Promise);};if(!this.manage){return React.createElement(SafeAreaView,{style:styles.container},React.createElement(Center,null,React.createElement(TouchableWithoutFeedback,{onPress:function onPress(){return _this3.setState({manage:true});}},React.createElement(View,{style:styles.newBudgetButton},React.createElement(Text,{style:styles.medium},React.createElement(FontAwesome,{name:\"plus\",size:24,color:\"black\"}),\"Add new Budget\"))),React.createElement(SafeAreaView,{style:styles.top},React.createElement(Text,{style:styles.medium},\"Budget Name\"),React.createElement(SafeAreaView,{style:styles.inner})),React.createElement(SafeAreaView,{style:styles.middle},React.createElement(Text,{style:styles.medium},\"Budget Name\"),React.createElement(SafeAreaView,{style:styles.inner})),React.createElement(LogoutButton,null)));}return React.createElement(SafeAreaView,{style:styles.container},React.createElement(Center,null,React.createElement(SafeAreaView,{style:styles.newBudgetHeader},React.createElement(Text,{style:styles.nBHeader},\"Add New Budgets\")),React.createElement(Text,{style:styles.mediumUp},\"Budget Name\"),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(em){return setEmail(em);}}),React.createElement(Text,{style:styles.mediumUp},\"Budget Goal\"),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(em){return setEmail(em);}}),React.createElement(Text,{style:styles.mediumUp},\"Starting Progress\"),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(em){return setEmail(em);}}),React.createElement(TouchableWithoutFeedback,{onPress:function onPress(){return _this3.setState({manage:false});}},React.createElement(View,{style:styles.addBudgetButton},React.createElement(Text,{style:styles.medium},React.createElement(FontAwesome,{name:\"plus\",size:24,color:\"black\"}),\"Add\")))));}}]);return Budgets;}(React.PureComponent);export{Budgets as default};var styles=StyleSheet.create({container:{flex:1,justifyContent:\"space-between\",padding:20,backgroundColor:'#19C0FF'},newBudgetHeader:{backgroundColor:'#fb2b60',width:414,flex:.24,bottom:70},nBHeader:{fontSize:48,alignSelf:'center',top:40},input:{width:315,flex:.15,backgroundColor:'white',borderTopLeftRadius:50,borderTopRightRadius:50,borderBottomLeftRadius:50,borderBottomRightRadius:50,margin:20,bottom:50},newBudgetButton:{flex:.1,backgroundColor:\"#fcb401\",width:350,bottom:0.5,borderTopLeftRadius:50,borderTopRightRadius:50,borderBottomLeftRadius:50,borderBottomRightRadius:50,alignItems:'center',justifyContent:'center',top:25},addBudgetButton:{flex:.13,backgroundColor:\"#fcb401\",width:350,bottom:0.5,borderTopLeftRadius:50,borderTopRightRadius:50,borderBottomLeftRadius:50,borderBottomRightRadius:50,alignItems:'center',justifyContent:'center'},submitButtonText:{color:'white'},large:{fontSize:28,justifyContent:'center',alignItems:'center'},medium:{fontSize:24,justifyContent:'center',alignItems:'center'},mediumUp:{fontSize:36,justifyContent:'center',alignItems:'center',bottom:40},inner:{backgroundColor:'#55D0F1',flex:0.80,width:350,borderTopLeftRadius:20,borderTopRightRadius:20,borderBottomLeftRadius:20,borderBottomRightRadius:20},top:{flex:0.4,backgroundColor:\"#19c0ff\",width:350,borderTopLeftRadius:20,borderTopRightRadius:20,borderBottomLeftRadius:20,borderBottomRightRadius:20,margin:10,alignItems:'center',paddingTop:10,top:40},label:{flex:0.15,backgroundColor:\"#fcb401\",width:350,borderTopLeftRadius:50,borderTopRightRadius:50,borderBottomLeftRadius:50,borderBottomRightRadius:50,alignItems:'center',justifyContent:'center'},middle:{flex:0.4,backgroundColor:\"#19c0ff\",width:350,borderTopLeftRadius:20,borderTopRightRadius:20,borderBottomLeftRadius:20,borderBottomRightRadius:20,margin:10,alignItems:'center',paddingTop:10,top:40}});","map":{"version":3,"sources":["/home/joeyg/Desktop/mobile-app/budgetbuddy-mobileapp/src/screens/Budgets.js"],"names":["React","useState","Center","LogoutButton","AsyncStorage","buildPath","FontAwesome","Budgets","props","state","budgets","show","currentBudget","rerender","changeAllowance","manage","obj","email","getItem","js","JSON","stringify","Promise","all","fetch","method","body","headers","then","res1","res2","json","total","i","results","length","BudgetGoal","BudgetProgress","setState","allowance","diff","index","newName","newGoal","handleClose","handleShow","event","preventDefault","currentTarget","getAttribute","name","remove","confirmAlert","title","message","buttons","label","onClick","deleteBudget","updateBudget","BudgetName","_id","response","text","txt","res","parse","error","Alert","alert","toString","addProgress","funds","parseInt","obj2","newAmount","js2","e","styles","container","newBudgetButton","medium","top","inner","middle","newBudgetHeader","nBHeader","mediumUp","input","em","setEmail","addBudgetButton","PureComponent","StyleSheet","create","flex","justifyContent","padding","backgroundColor","width","bottom","fontSize","alignSelf","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","margin","alignItems","submitButtonText","color","large","paddingTop"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\n//import ReactApexChart from 'react-apexcharts'\nimport { Center } from '../components/Center';\nimport { SafeAreaView,Text, Button, StyleSheet,  TouchableWithoutFeedback, View, ScrollView, TextInput } from 'react-native';\nimport { LogoutButton } from '../components/LogoutButton';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { buildPath } from '../functions/BuildPath';\nimport { FontAwesome } from '@expo/vector-icons'; \n\nexport default class Budgets extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            budgets: [],\n            show: false,\n            currentBudget: -1,\n            rerender: false,\n            changeAllowance: false, \n            manage: false\n        }\n    }\n\n    async componentDidMount() {\n        var obj = {email: AsyncStorage.getItem(\"email\")};\n        var js = JSON.stringify(obj);\n        Promise.all([\n            fetch(buildPath('api/showAllBudgets'),\n            {method:'POST', body: js, headers:{'Content-Type': 'application/json', 'Authorization': 'Bearer ' + AsyncStorage.getItem(\"token\")}}),\n            fetch(buildPath('api/getAllowance'),\n                {method:'POST', body: js, headers: {'Content-Type': 'application/json'}})    \n        ])\n            .then(([res1, res2]) => {\n                return Promise.all([res1.json(), res2.json()])\n        })\n        .then(([res1, res2]) => {\n            var total = 0;\n            for (var i = 0; i < res1.results.length; i++)\n            total += (res1.results[i].BudgetGoal - res1.results[i].BudgetProgress);\n            this.setState({\n            budgets: res1.results,\n            allowance: res2.allowance,\n            diff : 0,\n            index: -1, \n            total : total\n            })\n        })\n    }\n\n    render () {\n        const { budgets, show, currentBudget, allowance, diff, index, total } = this.state;\n        //const [manage, setManage] = React.useState(false);\n\n        var newName = '', newGoal ='';\n    \n        const handleClose = () => this.setState({show: false});\n        const handleShow = async event => {\n          event.preventDefault();\n          const index = event.currentTarget.getAttribute(\"data-id\");\n          this.setState({show: true, currentBudget: index, name:budgets[index].name});\n        }\n\n        const remove = event => {\n            handleClose();\n            confirmAlert({\n              title: 'Confirm to delete',\n              message: 'Are you sure you want to delete this budget?',\n              buttons: [\n                {\n                  label: 'Yes',\n                  onClick: () => deleteBudget()\n                },\n                {\n                  label: 'No',\n                  onClick: () => this.setState({show: true, currentBudget: event.currentTarget.getAttribute(\"data-id\")})\n                }\n              ]\n            });\n          };\n\n        const updateBudget = async event => {\n            event.preventDefault();\n    \n            var obj = {BudgetName: newName, BudgetGoal: newGoal,\n                _id:event.currentTarget.getAttribute(\"data-id\")};\n            var js = JSON.stringify(obj);\n        \n            try\n            {\n                // Call to API\n                const response = await fetch(buildPath('api/updatebudget'),\n                    {method:'POST',body:js,headers:{'Content-Type': 'application/json', 'Authorization': 'Bearer ' + AsyncStorage.getItem(\"token\")}});\n        \n                // Parsing response\n                var txt = await response.text();\n                var res = JSON.parse(txt);\n        \n                if( res.error.length > 0 )\n                {\n                    Alert.alert( \"API Error:\" + res.error );\n                }\n                else\n                {\n                    this.setState({index: -1});\n                //\n                }\n            }\n            catch(e)\n            {\n                Alert.alert(e.toString());\n            }\n        }\n\n        const addProgress = async event => {\n            event.preventDefault();\n      \n            if (allowance + diff < 0) {\n              Alert.alert(\"You can't save your progress as you have a negative allowance.\");\n              return;\n            }\n      \n            const index = event.currentTarget.getAttribute(\"data-index\");\n            var obj = {email: AsyncStorage.getItem(\"email\"), funds: parseInt(allowance + diff)};\n            var js = JSON.stringify(obj);\n      \n            const obj2 = {newAmount: budgets[index].BudgetProgress,\n              _id:event.currentTarget.getAttribute(\"data-id\")};\n            const js2 = JSON.stringify(obj2);\n      \n                try\n                {\n                    // Call to API\n                    Promise.all([\n                    fetch(buildPath('api/addAllowance'),\n                        {method:'POST',body:js,headers:{'Content-Type': 'application/json', 'Authorization': 'Bearer ' + AsyncStorage.getItem(\"token\")}}),\n                        fetch(buildPath('api/addprogress'),\n                        {method:'POST',body:js2,headers:{'Content-Type': 'application/json', 'Authorization': 'Bearer ' + AsyncStorage.getItem(\"token\")}})\n                    ]).then(([res1, res2]) => {\n                        return Promise.all([res1.json(), res2.json()])\n                    }).then(([res1, res2]) => {\n                    this.setState({index: -1});\n                    //window.location.href = \"/budget\";\n                    })\n                }\n                catch(e)\n                {\n                    alert(e.toString() + \"yee\");\n                }\n            }\n\n        //const [manage, setManage] = React.useState(false);\n        if (!this.manage)\n        {\n            return (\n                <SafeAreaView style={styles.container}>\n                    <Center>\n                        <TouchableWithoutFeedback onPress={() => this.setState({manage:true})}>\n                            <View style={styles.newBudgetButton}>\n                            <Text style={styles.medium}>\n                                <FontAwesome name=\"plus\" size={24} color=\"black\" /> \n                                    Add new Budget\n                            </Text>\n                            </View>\n                        </TouchableWithoutFeedback>\n                        <SafeAreaView style={styles.top}>\n                            <Text style={styles.medium}>Budget Name</Text>\n                            <SafeAreaView style={styles.inner}>\n                            </SafeAreaView>\n                        </SafeAreaView>\n                        <SafeAreaView style={styles.middle}>\n                            <Text style={styles.medium}>Budget Name</Text>\n                            <SafeAreaView style={styles.inner}>\n                            </SafeAreaView>\n                        </SafeAreaView>\n                        <LogoutButton/>\n                    </Center>\n                </SafeAreaView>\n            );\n        }\n\n        return (\n            <SafeAreaView style={styles.container}>\n                    <Center>\n                        <SafeAreaView style={styles.newBudgetHeader}>\n                            <Text style={styles.nBHeader}>Add New Budgets</Text>\n                        </SafeAreaView>\n                        <Text style={styles.mediumUp}>Budget Name</Text>\n                        <TextInput style={styles.input}\n                        onChangeText={em => setEmail(em)}>\n                        </TextInput>\n                        <Text style={styles.mediumUp}>Budget Goal</Text>\n                        <TextInput style={styles.input}\n                        onChangeText={em => setEmail(em)}>\n                        </TextInput>\n                        <Text style={styles.mediumUp}>Starting Progress</Text>\n                        <TextInput style={styles.input}\n                        onChangeText={em => setEmail(em)}>\n                        </TextInput>\n                        <TouchableWithoutFeedback onPress={() => this.setState({manage:false})}>\n                        <View style={styles.addBudgetButton}>\n                        <Text style={styles.medium}>\n                            <FontAwesome name=\"plus\" size={24} color=\"black\" /> \n                                Add\n                        </Text>\n                        </View>\n                    </TouchableWithoutFeedback>\n                    </Center>\n                </SafeAreaView>\n        );\n    }\n}\n\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        justifyContent: \"space-between\",\n        padding: 20,\n        backgroundColor: '#19C0FF'\n    },\n    newBudgetHeader: {\n        backgroundColor: '#fb2b60',\n        width: 414,\n        flex: .24,\n        bottom: 70\n    },\n    nBHeader: {\n        fontSize: 48,\n        alignSelf: 'center',\n        top: 40\n    },\n    input: {\n        width: 315,\n        flex: .15,\n        backgroundColor: 'white',\n        borderTopLeftRadius: 50,\n        borderTopRightRadius: 50,\n        borderBottomLeftRadius: 50,\n        borderBottomRightRadius: 50,\n        margin: 20, \n        bottom: 50\n    },\n    newBudgetButton: {\n        flex: .1,\n        backgroundColor: \"#fcb401\",\n        width: 350,\n        bottom: 0.5,\n        borderTopLeftRadius: 50,\n        borderTopRightRadius: 50,\n        borderBottomLeftRadius: 50,\n        borderBottomRightRadius: 50,\n        alignItems: 'center',\n        justifyContent: 'center',\n        top: 25\n    },\n    addBudgetButton: {\n        flex: .13,\n        backgroundColor: \"#fcb401\",\n        width: 350,\n        bottom: 0.5,\n        borderTopLeftRadius: 50,\n        borderTopRightRadius: 50,\n        borderBottomLeftRadius: 50,\n        borderBottomRightRadius: 50,\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    submitButtonText: {\n        color: 'white'\n    },\n    large: {\n        fontSize: 28,\n        justifyContent: 'center',\n        alignItems: 'center',\n    },\n    medium: {\n        fontSize: 24,\n        justifyContent: 'center',\n        alignItems: 'center'\n    },\n    mediumUp: {\n        fontSize: 36,\n        justifyContent: 'center',\n        alignItems: 'center',\n        bottom: 40\n    },\n    inner: {\n        backgroundColor: '#55D0F1',\n        flex: 0.80,\n        width: 350, borderTopLeftRadius: 20,\n        borderTopRightRadius: 20,\n        borderBottomLeftRadius: 20,\n        borderBottomRightRadius: 20\n    },\n    top: {\n        flex: 0.4,\n        backgroundColor: \"#19c0ff\",\n        width: 350,\n        borderTopLeftRadius: 20,\n        borderTopRightRadius: 20,\n        borderBottomLeftRadius: 20,\n        borderBottomRightRadius: 20,\n        margin: 10,\n        alignItems: 'center', \n        paddingTop: 10,\n        top: 40,\n    },\n    label: {\n        flex: 0.15,\n        backgroundColor: \"#fcb401\",\n        width: 350,\n        borderTopLeftRadius: 50,\n        borderTopRightRadius: 50,\n        borderBottomLeftRadius: 50,\n        borderBottomRightRadius: 50,\n        alignItems: 'center',\n        justifyContent: 'center'\n    },\n    middle: {\n        flex: 0.4,\n        backgroundColor: \"#19c0ff\",\n        width: 350,\n        borderTopLeftRadius: 20,\n        borderTopRightRadius: 20,\n        borderBottomLeftRadius: 20,\n        borderBottomRightRadius: 20,\n        margin: 10,\n        alignItems: 'center',\n        paddingTop: 10,\n        top: 40,\n    },\n});\n\n//export default Budgets;"]},"metadata":{},"sourceType":"module"}