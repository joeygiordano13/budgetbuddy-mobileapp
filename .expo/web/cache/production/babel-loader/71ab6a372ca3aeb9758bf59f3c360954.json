{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _objectDestructuringEmpty from\"@babel/runtime/helpers/objectDestructuringEmpty\";import React,{useState,useContext}from\"react\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Button from\"react-native-web/dist/exports/Button\";import Alert from\"react-native-web/dist/exports/Alert\";import Text from\"react-native-web/dist/exports/Text\";import SafeAreaView from\"react-native-web/dist/exports/SafeAreaView\";import ImageBackground from\"react-native-web/dist/exports/ImageBackground\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Keyboard from\"react-native-web/dist/exports/Keyboard\";import{createStackNavigator}from\"@react-navigation/stack\";import{buildPath}from\"./functions/BuildPath\";import{Center}from\"./components/Center\";import{AuthContext}from\"./AuthProvider\";import{Card}from'react-native-paper';import AsyncStorage from'@react-native-async-storage/async-storage';var Stack=createStackNavigator();export var AuthStack=function AuthStack(_ref){_objectDestructuringEmpty(_ref);return React.createElement(Stack.Navigator,{initialRouteName:\"Login\"},React.createElement(Stack.Screen,{options:{headerTitle:\"Sign In\"},name:\"Login\",component:Login}),React.createElement(Stack.Screen,{options:{headerTitle:\"Sign Up\"},name:\"Register\",component:Register}));};function Login(_ref2){var navigation=_ref2.navigation;var _useContext=useContext(AuthContext),login=_useContext.login;var _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),loginEmail=_React$useState2[0],setEmail=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),loginPassword=_React$useState4[0],setPassword=_React$useState4[1];var message='';var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showAlert=_useState2[0],setAlert=_useState2[1];var doLogin=function doLogin(event){var obj,js,response,res;return _regeneratorRuntime.async(function doLogin$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();obj={email:loginEmail,password:loginPassword};js=JSON.stringify(obj);_context.prev=3;_context.next=6;return _regeneratorRuntime.awrap(fetch(buildPath('api/login'),{method:'POST',body:js,headers:{'Content-Type':'application/json'}}));case 6:response=_context.sent;_context.t0=JSON;_context.next=10;return _regeneratorRuntime.awrap(response.text());case 10:_context.t1=_context.sent;res=_context.t0.parse.call(_context.t0,_context.t1);if(res.error!=''){Alert.alert('incorrect login, userID: '+res.id+'\\n');console.log('incorrect login email: '+loginEmail+'\\n');message='Email/Password combination incorrect';setAlert(true);}else{Alert.alert('success login, token: '+res.accessToken+'\\n');AsyncStorage.setItem('userID',res.id);AsyncStorage.setItem('token',res.accessToken);login();}_context.next=19;break;case 15:_context.prev=15;_context.t2=_context[\"catch\"](3);Alert.alert(\"failure login email: \"+_context.t2+\"\\n\");return _context.abrupt(\"return\");case 19:case\"end\":return _context.stop();}}},null,null,[[3,15]],Promise);};return React.createElement(ImageBackground,{style:styles.backgroundImage,source:require(\"../assets/bubblebackground.png\")},React.createElement(Center,null,React.createElement(SafeAreaView,{style:styles.loginBox},React.createElement(SafeAreaView,{style:{left:45}},React.createElement(Button,{style:styles.submitButton,title:\"Register\",color:\"#FB2B60\",onPress:function onPress(){navigation.navigate(\"Register\");}})),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(em){return setEmail(em);},placeholder:\"Email\",value:loginEmail}),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(pw){return setPassword(pw);},placeholder:\"Password\",value:loginPassword}),React.createElement(Button,{style:styles.submitButton,color:\"#FB2B60\",title:\"Login\",onPress:doLogin}),React.createElement(Text,{style:styles.medium},\"Forgot Password? Click here.\"))));};function Register(_ref3){var navigation=_ref3.navigation;var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),registerUsername=_React$useState6[0],setUsername=_React$useState6[1];var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),registerEmail=_React$useState8[0],setEmail=_React$useState8[1];var _React$useState9=React.useState(''),_React$useState10=_slicedToArray(_React$useState9,2),password=_React$useState10[0],setPassword=_React$useState10[1];var _React$useState11=React.useState(''),_React$useState12=_slicedToArray(_React$useState11,2),passwordConfirm=_React$useState12[0],setPasswordConfirm=_React$useState12[1];var budgetAndFriends=[];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var doRegistration=function doRegistration(event){var obj,js,response,res;return _regeneratorRuntime.async(function doRegistration$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();if(!(registerEmail.value.length===0||registerUsername.value.length===0||password.value.length===0||passwordConfirm.value.length===0)){_context2.next=5;break;}setMessage(\"Please fill in all fields\");Alert.alert(message);return _context2.abrupt(\"return\");case 5:if(!(password.value!=passwordConfirm.value)){_context2.next=9;break;}setMessage(\"Passwords do not match\");Alert.alert(message);return _context2.abrupt(\"return\");case 9:obj={email:registerEmail,username:registerUsername,verification:false,friends:budgetAndFriends,password:password,rankMetric:-1};js=JSON.stringify(obj);_context2.prev=11;_context2.next=14;return _regeneratorRuntime.awrap(fetch(buildPath('api/register'),{method:'POST',body:js,headers:{'Content-Type':'application/json'}}));case 14:response=_context2.sent;_context2.t0=JSON;_context2.next=18;return _regeneratorRuntime.awrap(response.text());case 18:_context2.t1=_context2.sent;res=_context2.t0.parse.call(_context2.t0,_context2.t1);if(res.error!=''){setMessage(res.error);Alert.alert(message);}else{setMessage(\"An email has been sent to \"+registerEmail.value+\". Please verify your email\");Alert.alert(message);}_context2.next=27;break;case 23:_context2.prev=23;_context2.t2=_context2[\"catch\"](11);Alert.alert(_context2.t2);return _context2.abrupt(\"return\");case 27:case\"end\":return _context2.stop();}}},null,null,[[11,23]],Promise);};return React.createElement(ImageBackground,{style:styles.backgroundImage,source:require(\"../assets/bubblebackground.png\")},React.createElement(SafeAreaView,{style:styles.loginBox},React.createElement(Center,null,React.createElement(Text,{style:styles.large},\"Register Form\"),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(u){return setUsername(u);},placeholder:\"Username\",value:registerUsername}),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(em){return setEmail(em);},placeholder:\"Email\",value:registerEmail}),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(pw){return setPassword(pw);},placeholder:\"Password\",value:password}),React.createElement(TextInput,{style:styles.input,onChangeText:function onChangeText(pw){return setPasswordConfirm(pw);},placeholder:\"Password\",value:passwordConfirm}),React.createElement(Button,{style:styles.submitButton,title:\"Register\",onPress:doRegistration}))));}var styles=StyleSheet.create({container:{flex:1,justifyContent:\"space-between\",padding:20,margin:10},input:{margin:1,height:40,width:150,backgroundColor:'white',borderColor:'white',borderWidth:1},submitButton:{backgroundColor:'#7a42f4',padding:10,margin:25,height:20},submitButtonText:{color:'white'},large:{fontSize:28},medium:{fontSize:15},backgroundImage:{flex:1,resizeMode:'cover'},loginBox:{flex:0.3,backgroundColor:\"#19c0ff\",width:250,borderWidth:2,borderTopLeftRadius:20,borderTopRightRadius:20,borderBottomLeftRadius:20,borderBottomRightRadius:20,margin:10,justifyContent:'center',alignItems:'center',paddingTop:20}});","map":{"version":3,"sources":["/home/joeyg/Desktop/mobile-app/budgetbuddy-mobileapp/src/AuthStack.js"],"names":["React","useState","useContext","createStackNavigator","buildPath","Center","AuthContext","Card","AsyncStorage","Stack","AuthStack","headerTitle","Login","Register","navigation","login","loginEmail","setEmail","loginPassword","setPassword","message","showAlert","setAlert","doLogin","event","preventDefault","obj","email","password","js","JSON","stringify","fetch","method","body","headers","response","text","res","parse","error","Alert","alert","id","console","log","accessToken","setItem","styles","backgroundImage","require","loginBox","left","submitButton","navigate","input","em","pw","medium","registerUsername","setUsername","registerEmail","passwordConfirm","setPasswordConfirm","budgetAndFriends","setMessage","doRegistration","value","length","username","verification","friends","rankMetric","large","u","StyleSheet","create","container","flex","justifyContent","padding","margin","height","width","backgroundColor","borderColor","borderWidth","submitButtonText","color","fontSize","resizeMode","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","alignItems","paddingTop"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from \"react\";\nimport { TextInput, Button, Alert, Text, SafeAreaView, ImageBackground, StyleSheet, Keyboard } from 'react-native';\nimport { createStackNavigator } from \"@react-navigation/stack\";\nimport { buildPath } from './functions/BuildPath';\nimport { Center } from './components/Center';\nimport { AuthContext } from './AuthProvider';\nimport { Card } from 'react-native-paper';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nconst Stack = createStackNavigator();\n\nexport const AuthStack = ({}) => {\n  return (\n    <Stack.Navigator initialRouteName=\"Login\">\n      <Stack.Screen\n        options={{\n          headerTitle: \"Sign In\"\n        }}\n        name=\"Login\"\n        component={Login}\n      />\n      <Stack.Screen\n        options={{\n          headerTitle: \"Sign Up\"\n        }}\n        name=\"Register\"\n        component={Register}\n      />\n    </Stack.Navigator>\n  );\n};\n\nfunction Login({navigation}) {\n  const {login} = useContext(AuthContext);\n\n  const [loginEmail, setEmail] = React.useState('');\n  const [loginPassword, setPassword] = React.useState('');\n\n  var message = '';\n\n  const [ showAlert, setAlert ] = useState(false);\n\n  const doLogin = async event => {\n      event.preventDefault();\n\n      var obj = {email:loginEmail, password:loginPassword};\n      var js = JSON.stringify(obj);\n      try\n      {\n          // API call\n          const response = await fetch(buildPath('api/login'),\n              {method:'POST',body:js,headers:{'Content-Type': 'application/json'}});\n\n          // Parse JSON response\n          var res = JSON.parse(await response.text());\n\n          if( res.error != '')\n          {\n            //Alert.alert(\"incorrect login email: \" + loginEmail + '\\n');\n            Alert.alert('incorrect login, userID: ' + res.id + '\\n');\n            console.log('incorrect login email: ' + loginEmail + '\\n');\n            message = 'Email/Password combination incorrect';\n            setAlert(true);\n          }\n          else\n          {\n            //console.log(\"success login email: \" + loginEmail + '\\n');\n            Alert.alert('success login, token: ' + res.accessToken + '\\n');\n            AsyncStorage.setItem('userID', res.id);\n            AsyncStorage.setItem('token', res.accessToken);\n            login();\n          }\n      }\n      catch(e)\n      {\n          Alert.alert(\"failure login email: \" + e + \"\\n\");\n          return;\n      }\n  }\n\n  return (\n      <ImageBackground \n      style={styles.backgroundImage} \n      source={require('../assets/bubblebackground.png')}>\n        <Center>\n          <SafeAreaView style={styles.loginBox}>\n            <SafeAreaView style={{left: 45}}>\n              <Button style={styles.submitButton}\n                title=\"Register\"\n                color=\"#FB2B60\"\n                onPress={() => {\n                  navigation.navigate(\"Register\");\n                }}/>\n            </SafeAreaView>\n            <TextInput style={styles.input}\n              onChangeText={em => setEmail(em)}\n              placeholder=\"Email\"\n              value={loginEmail}>\n            </TextInput>\n            <TextInput style={styles.input}\n              onChangeText={pw => setPassword(pw)}\n              placeholder=\"Password\"\n              value={loginPassword}/>\n            <Button style={styles.submitButton}\n            color=\"#FB2B60\"\n            title=\"Login\"\n            onPress={doLogin}/>\n            <Text style={styles.medium}>Forgot Password? Click here.</Text>\n          </SafeAreaView>\n        </Center>\n      </ImageBackground>\n  );\n};\n\nfunction Register({ navigation }) {\n  // Register usestates\n  const [registerUsername, setUsername] = React.useState('');\n  const [registerEmail, setEmail] = React.useState('');\n  const [password, setPassword] = React.useState('');\n  const [passwordConfirm, setPasswordConfirm] = React.useState('');\n\n  var budgetAndFriends = [];\n  \n  const [ message, setMessage ] = useState('');\n  \n  const doRegistration = async event => {\n    event.preventDefault();\n    if (registerEmail.value.length === 0 || registerUsername.value.length === 0\n        || password.value.length === 0 || passwordConfirm.value.length === 0) {\n          setMessage(\"Please fill in all fields\");\n          Alert.alert(message);\n          return;\n        }\n    if (password.value != passwordConfirm.value) {\n      setMessage(\"Passwords do not match\");\n      Alert.alert(message);\n      return;\n    }\n\n    var obj = {email: registerEmail, username: registerUsername, verification: false,\n              friends: budgetAndFriends, password: password, rankMetric: -1};\n    var js = JSON.stringify(obj);\n\n    try {\n      const response = await fetch(buildPath('api/register'),\n            {method:'POST', body:js, headers:{'Content-Type': 'application/json'}});\n\n      var res = JSON.parse(await response.text());\n\n      if (res.error != '') {\n        setMessage(res.error);\n        Alert.alert(message);\n      } else {\n        setMessage(\"An email has been sent to \" + registerEmail.value + \". Please verify your email\");\n        Alert.alert(message);\n      }\n    } catch (e) {\n      Alert.alert(e);\n      return;\n    }\n  }\n\n  return (\n    <ImageBackground \n    style={styles.backgroundImage} \n    source={require('../assets/bubblebackground.png')}>\n      <SafeAreaView style={styles.loginBox}>\n        <Center>\n          <Text style={styles.large}>Register Form</Text>\n          <TextInput style={styles.input}\n            onChangeText={u => setUsername(u)}\n            placeholder=\"Username\"\n            value={registerUsername}></TextInput>\n          <TextInput style={styles.input}\n            onChangeText={em => setEmail(em)}\n            placeholder=\"Email\"\n            value={registerEmail}></TextInput>\n          <TextInput style={styles.input}\n            onChangeText={pw => setPassword(pw)}\n            placeholder=\"Password\"\n            value={password}></TextInput>\n          <TextInput style={styles.input}\n            onChangeText={pw => setPasswordConfirm(pw)}\n            placeholder=\"Password\"\n            value={passwordConfirm}></TextInput>\n          <Button style={styles.submitButton}\n            title=\"Register\"\n            onPress={doRegistration}/>\n        </Center>\n      </SafeAreaView>\n    </ImageBackground>  \n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"space-between\",\n    padding: 20,\n    margin: 10,\n  },\n  input: {\n    margin: 1,\n    height: 40,\n    width: 150,\n    backgroundColor: 'white',\n    borderColor: 'white',\n    borderWidth: 1,\n  },\n  submitButton: {\n    backgroundColor: '#7a42f4',\n    padding: 10,\n    margin: 25,\n    height: 20,\n  },\n  submitButtonText: {\n    color: 'white'\n  },\n  large: {\n    fontSize: 28\n  },\n  medium: {\n    fontSize: 15\n  },\n  backgroundImage: {\n    flex: 1,\n    resizeMode: 'cover',\n  }, \n  loginBox: {\n    flex: 0.3,\n    backgroundColor: \"#19c0ff\",\n    width: 250,\n    borderWidth: 2,\n    borderTopLeftRadius: 20,\n    borderTopRightRadius: 20,\n    borderBottomLeftRadius: 20,\n    borderBottomRightRadius: 20,\n    margin: 10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingTop: 20\n},\n});"]},"metadata":{},"sourceType":"module"}